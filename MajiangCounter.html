<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <!-- PWA é…ç½® -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="éº»å°†è®¡æ•°å™¨">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

<!-- å›¾æ ‡ï¼ˆiOS æ·»åŠ åˆ°ä¸»å±æ—¶æ˜¾ç¤ºï¼‰ -->
<link rel="apple-touch-icon" href="icon-192.png" sizes="192x192">
<link rel="apple-touch-icon" href="icon-256.png" sizes="256x256">
<link rel="apple-touch-icon" href="icon-512.png" sizes="512x512">

<!-- å¯åŠ¨ç”»é¢ï¼ˆå¯é€‰ï¼‰ -->
<link rel="apple-touch-startup-image" href="splash.png">

<!-- ä¸»é¢˜é¢œè‰² -->
<meta name="theme-color" content="#d4380d">
  <link rel="manifest" href="manifest.json">
  <title>éº»å°†ç‰Œè®¡æ•°å™¨</title>
  <style>
    body {
      font-family: "Microsoft YaHei", Arial, sans-serif;
      text-align: center;
      margin: 20px;
      background-color: #f7f7f7;
    }
    h1 {
      color: #d4380d;
      font-size: 28px;
    }
    .subtitle {
      color: #555;
      font-size: 16px;
    }
    .section-title {
      font-size: 18px;
      font-weight: bold;
      color: #005a9c;
      margin-top: 10px;
      margin-bottom: 5px;
    }
    .container {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 30px auto;
      max-width: 1400px;
      flex-wrap: wrap;
    }
    .module {
      background: white;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 4px 16px rgba(0,0,0,0.15);
      width: 280px;
      min-height: 380px;
    }
    .counter-box {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      margin-bottom: 10px;
    }
    .counter-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    .counter-item.hidden {
      opacity: 0;
      transform: scale(0.7);
      height: 0;
      overflow: hidden;
      padding: 0;
      margin: 0;
    }
    .counter-label {
      font-weight: bold;
      color: #333;
      margin-bottom: 4px;
    }
    .counter {
      font-size: 28px;
      font-weight: bold;
      color: #e6550d;
      margin: 4px 0;
    }
    button {
      font-size: 14px;
      padding: 6px 10px;
      background-color: #e74c3c;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    button:hover:not(:disabled) {
      background-color: #c0392b;
    }
    .sum-display {
      font-size: 18px;
      font-weight: bold;
      color: #005a9c;
      margin-top: 10px;
      padding: 10px;
      background-color: #f0f8ff;
      border-radius: 8px;
      border: 1px solid #bbdffd;
    }
    .reset-btn {
      margin-top: 20px;
      background-color: #3498db;
      font-size: 18px;
      padding: 12px 25px;
      border-radius: 8px;
      color: white;
      border: none;
      cursor: pointer;
      font-weight: bold;
    }
    .reset-btn:hover {
      background-color: #2980b9;
    }
  </style>
</head>
<body>

  <h1>ğŸ€„ éº»å°†ç‰Œè®¡æ•°å™¨</h1>
  <p class="subtitle">æ¯ç§ç‰Œå…± <strong>4 å¼ </strong>ï¼Œæ‰“å‡ºä¸€å¼ å‡ä¸€ï¼Œæ‰“å®Œè‡ªåŠ¨éšè—</p>

  <div class="container" id="modules-container">
    <!-- JavaScript åŠ¨æ€ç”Ÿæˆ -->
  </div>

  <button class="reset-btn" onclick="resetAll()">ğŸ”„ é‡æ–°æ´—ç‰Œ</button>

  <script>
    const totalModules = 3;
    const countersPerModule = 9;
    const initialValue = 4;
    const totalCounter = totalModules * countersPerModule;

    // æ‰€æœ‰è®¡æ•°å™¨å½“å‰å€¼
    let counters = Array(totalCounter).fill(initialValue);

    // æ¯ç»„çš„åç§°æ˜ å°„
    const labels = [
      // æ¨¡å—1ï¼šä¸‡
      'ä¸€ä¸‡', 'äºŒä¸‡', 'ä¸‰ä¸‡', 'å››ä¸‡', 'äº”ä¸‡', 'å…­ä¸‡', 'ä¸ƒä¸‡', 'å…«ä¸‡', 'ä¹ä¸‡',
      // æ¨¡å—2ï¼šç­’
      'ä¸€ç­’', 'äºŒç­’', 'ä¸‰ç­’', 'å››ç­’', 'äº”ç­’', 'å…­ç­’', 'ä¸ƒç­’', 'å…«ç­’', 'ä¹ç­’',
      // æ¨¡å—3ï¼šæ¡ï¼ˆå¹ºé¸¡ç‰¹æ®Šï¼‰
      'å¹ºé¸¡', 'äºŒæ¡', 'ä¸‰æ¡', 'å››æ¡', 'äº”æ¡', 'å…­æ¡', 'ä¸ƒæ¡', 'å…«æ¡', 'ä¹æ¡'
    ];

    // é¡µé¢åŠ è½½ç”Ÿæˆç»“æ„
    window.onload = function () {
      const container = document.getElementById('modules-container');

      const moduleNames = ['ä¸‡å­', 'ç­’å­', 'æ¡å­'];

      for (let m = 0; m < totalModules; m++) {
        const module = document.createElement('div');
        module.className = 'module';

        module.innerHTML = `
          <div class="section-title">${moduleNames[m]}</div>
          <div class="counter-box" id="module-${m}-counters"></div>
          <div class="sum-display" id="sum-${m}">å‰©ä½™ï¼š${9 * initialValue}</div>
        `;

        const counterBox = module.querySelector(`#module-${m}-counters`);
        for (let i = 0; i < countersPerModule; i++) {
          const id = m * 9 + i + 1; // 1~27
          const item = document.createElement('div');
          item.className = 'counter-item';
          item.id = `item-${id}`;
          item.innerHTML = `
            <div class="counter-label">${labels[id - 1]}</div>
            <div class="counter" id="counter${id}">${initialValue}</div>
            <button id="btn${id}" onclick="decrement(${id})">å‡ºç‰Œ</button>
          `;
          counterBox.appendChild(item);
        }

        container.appendChild(module);
      }

      updateAllSums();
    };

    // å‡ä¸€å‡½æ•°
    function decrement(id) {
      const index = id - 1;
      if (counters[index] > 0) {
        counters[index]--;
        updateDisplay(id);

        // æ›´æ–°æ‰€å±æ¨¡å—æ€»å’Œ
        const moduleIndex = Math.floor((id - 1) / 9);
        updateSum(moduleIndex);

        // å¦‚æœå½’é›¶ï¼Œéšè—
        if (counters[index] === 0) {
          hideItem(id);
        }
      }
    }

    // æ›´æ–°æ˜¾ç¤º
    function updateDisplay(id) {
      const counterElement = document.getElementById(`counter${id}`);
      counterElement.textContent = counters[id - 1];
    }

    // éšè—è®¡æ•°å™¨
    function hideItem(id) {
      const item = document.getElementById(`item-${id}`);
      if (item && !item.classList.contains('hidden')) {
        item.classList.add('hidden');
      }
    }

    // æ˜¾ç¤ºè®¡æ•°å™¨ï¼ˆé‡ç½®æ—¶ï¼‰
    function showItem(id) {
      const item = document.getElementById(`item-${id}`);
      if (item) {
        item.classList.remove('hidden');
      }
    }

    // æ›´æ–°æŸæ¨¡å—æ€»å’Œ
    function updateSum(m) {
      const start = m * 9;
      const end = start + 9;
      const sum = counters.slice(start, end).reduce((a, b) => a + b, 0);
      document.getElementById(`sum-${m}`).textContent = `å‰©ä½™ï¼š${sum}`;
    }

    // æ›´æ–°æ‰€æœ‰æ¨¡å—æ€»å’Œ
    function updateAllSums() {
      for (let m = 0; m < 3; m++) {
        updateSum(m);
      }
    }

    // é‡ç½®æ‰€æœ‰
    function resetAll() {
      counters = Array(totalCounter).fill(initialValue);

      for (let i = 1; i <= totalCounter; i++) {
        document.getElementById(`counter${i}`).textContent = initialValue;
        showItem(i); // æ¢å¤æ˜¾ç¤º
      }

      updateAllSums(); // é‡ç®—
    }
  </script>

</body>
</html>
